{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport axios from 'axios';\nimport Router from 'next/router';\nimport { SITE_URL } from '../context/types';\nexport function myGet(url, ctx) {\n  var _ctx$req;\n\n  var cookie, data;\n  return _regeneratorRuntime.async(function myGet$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          cookie = (_ctx$req = ctx.req) === null || _ctx$req === void 0 ? void 0 : _ctx$req.headers.cookie;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(axios(\"\".concat(SITE_URL).concat(url), {\n            headers: {\n              cookie: cookie\n            }\n          }));\n\n        case 3:\n          data = _context.sent;\n\n          if (!(data.status === 401 && !ctx.req)) {\n            _context.next = 7;\n            break;\n          }\n\n          Router.replace('/login');\n          return _context.abrupt(\"return\", {});\n\n        case 7:\n          if (!(data.status === 401 && ctx.req)) {\n            _context.next = 11;\n            break;\n          }\n\n          ctx.res.writeHead(302, {\n            Location: \"\".concat(SITE_URL, \"/login\")\n          });\n          ctx.res.end();\n          return _context.abrupt(\"return\");\n\n        case 11:\n          return _context.abrupt(\"return\", data);\n\n        case 12:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n} // export default token => {\n//   if (token) {\n//     axios.defaults.headers.common['x-auth-token'] = token;\n//   } else {\n//     delete axios.defaults.headers.common['x-auth-token'];\n//   }\n// };","map":{"version":3,"sources":["C:/Users/Eduardo Rivas/Desktop/react_Study/popcornFun/components/utility/setAuthToken.js"],"names":["axios","Router","SITE_URL","myGet","url","ctx","cookie","req","headers","data","status","replace","res","writeHead","Location","end"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,QAAT,QAAyB,kBAAzB;AAEA,OAAO,SAAeC,KAAf,CAAqBC,GAArB,EAA0BC,GAA1B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,UAAAA,MADD,eACUD,GAAG,CAACE,GADd,6CACU,SAASC,OAAT,CAAiBF,MAD3B;AAAA;AAAA,2CAGcN,KAAK,WAAIE,QAAJ,SAAeE,GAAf,GAAsB;AAC5CI,YAAAA,OAAO,EAAE;AAAEF,cAAAA,MAAM,EAANA;AAAF;AADmC,WAAtB,CAHnB;;AAAA;AAGCG,UAAAA,IAHD;;AAAA,gBAODA,IAAI,CAACC,MAAL,KAAgB,GAAhB,IAAuB,CAACL,GAAG,CAACE,GAP3B;AAAA;AAAA;AAAA;;AAQHN,UAAAA,MAAM,CAACU,OAAP,CAAe,QAAf;AARG,2CASI,EATJ;;AAAA;AAAA,gBAYDF,IAAI,CAACC,MAAL,KAAgB,GAAhB,IAAuBL,GAAG,CAACE,GAZ1B;AAAA;AAAA;AAAA;;AAaHF,UAAAA,GAAG,CAACO,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AACrBC,YAAAA,QAAQ,YAAKZ,QAAL;AADa,WAAvB;AAGAG,UAAAA,GAAG,CAACO,GAAJ,CAAQG,GAAR;AAhBG;;AAAA;AAAA,2CAoBEN,IApBF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,C,CAuBP;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import axios from 'axios';\r\nimport Router from 'next/router';\r\nimport { SITE_URL } from '../context/types';\r\n\r\nexport async function myGet(url, ctx) {\r\n  const cookie = ctx.req?.headers.cookie;\r\n\r\n  const data = await axios(`${SITE_URL}${url}`, {\r\n    headers: { cookie },\r\n  });\r\n\r\n  if (data.status === 401 && !ctx.req) {\r\n    Router.replace('/login');\r\n    return {};\r\n  }\r\n\r\n  if (data.status === 401 && ctx.req) {\r\n    ctx.res.writeHead(302, {\r\n      Location: `${SITE_URL}/login`,\r\n    });\r\n    ctx.res.end();\r\n    return;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\n// export default token => {\r\n//   if (token) {\r\n//     axios.defaults.headers.common['x-auth-token'] = token;\r\n//   } else {\r\n//     delete axios.defaults.headers.common['x-auth-token'];\r\n//   }\r\n// };\r\n"]},"metadata":{},"sourceType":"module"}