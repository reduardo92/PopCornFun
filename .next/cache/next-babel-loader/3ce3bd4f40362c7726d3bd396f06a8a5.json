{"ast":null,"code":"const jwt = require('jsonwebtoken');\n\nconst auth = (req, res, next) => {\n  // Get token from header\n  const token = req.headers['x-auth-token'];\n  console.log(token); // Check if not token\n\n  if (!token) {\n    return res.status(401).json({\n      msg: 'No token, authorization denied'\n    });\n  }\n\n  try {\n    const decoded = jwt.verify(token, process.env.jwtSecret);\n    req.user = decoded.user;\n    next();\n  } catch (err) {\n    res.status(401).json({\n      msg: 'token is not valid'\n    });\n  }\n};\n\nexport default auth;","map":{"version":3,"sources":["C:/Users/Eduardo Rivas/Desktop/react_Study/popcornFun/server/middleware/auth.js"],"names":["jwt","require","auth","req","res","next","token","headers","console","log","status","json","msg","decoded","verify","process","env","jwtSecret","user","err"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,MAAMC,IAAI,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;AAC/B;AACA,QAAMC,KAAK,GAAGH,GAAG,CAACI,OAAJ,CAAY,cAAZ,CAAd;AAEAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ,EAJ+B,CAK/B;;AACA,MAAI,CAACA,KAAL,EAAY;AACV,WAAOF,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,GAAG,EAAE;AAAP,KAArB,CAAP;AACD;;AAED,MAAI;AACF,UAAMC,OAAO,GAAGb,GAAG,CAACc,MAAJ,CAAWR,KAAX,EAAkBS,OAAO,CAACC,GAAR,CAAYC,SAA9B,CAAhB;AACAd,IAAAA,GAAG,CAACe,IAAJ,GAAWL,OAAO,CAACK,IAAnB;AACAb,IAAAA,IAAI;AACL,GAJD,CAIE,OAAOc,GAAP,EAAY;AACZf,IAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,GAAG,EAAE;AAAP,KAArB;AACD;AACF,CAjBD;;AAkBA,eAAeV,IAAf","sourcesContent":["const jwt = require('jsonwebtoken');\r\n\r\nconst auth = (req, res, next) => {\r\n  // Get token from header\r\n  const token = req.headers['x-auth-token'];\r\n\r\n  console.log(token);\r\n  // Check if not token\r\n  if (!token) {\r\n    return res.status(401).json({ msg: 'No token, authorization denied' });\r\n  }\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, process.env.jwtSecret);\r\n    req.user = decoded.user;\r\n    next();\r\n  } catch (err) {\r\n    res.status(401).json({ msg: 'token is not valid' });\r\n  }\r\n};\r\nexport default auth;\r\n"]},"metadata":{},"sourceType":"module"}